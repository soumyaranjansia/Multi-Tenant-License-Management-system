{
  "info": {
    "name": "Gov2Biz API Collection",
    "_postman_id": "gov2biz-api-v1",
    "description": "Complete API collection for Gov2Biz Multi-Tenant License Management System with Payment-First Workflow. Supports buying licenses through integrated Razorpay payment gateway.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{jwtToken}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "tenantId",
      "value": "tenant-001",
      "type": "string"
    },
    {
      "key": "licenseId",
      "value": "",
      "type": "string"
    },
    {
      "key": "paymentId",
      "value": "",
      "type": "string"
    },
    {
      "key": "razorpayOrderId",
      "value": "",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has accessToken\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('accessToken');",
                  "    pm.environment.set(\"jwtToken\", jsonData.accessToken);",
                  "});",
                  "",
                  "pm.test(\"Token type is Bearer\", function () {",
                  "    pm.expect(pm.response.json().tokenType).to.eql('Bearer');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin@local\",\n  \"password\": \"Password123!\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        }
      ]
    },
    {
      "name": "License Management",
      "item": [
        {
          "name": "Get License Types",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/license/types",
              "host": ["{{baseUrl}}"],
              "path": ["license", "types"]
            }
          }
        },
        {
          "name": "Buy New License",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Response has id\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('id');",
                  "    pm.environment.set(\"licenseId\", jsonData.id);",
                  "});",
                  "",
                  "pm.test(\"TenantId matches request\", function () {",
                  "    pm.expect(pm.response.json().tenantId).to.eql(pm.environment.get(\"tenantId\"));",
                  "});",
                  "",
                  "pm.test(\"License number is generated\", function () {",
                  "    pm.expect(pm.response.json().licenseNumber).to.match(/^LIC-\\d{4}-\\d{6}$/);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"applicantName\": \"John Doe\",\n  \"applicantEmail\": \"john.doe@example.com\",\n  \"licenseType\": \"Business License\",\n  \"expiryDate\": \"2026-11-01T00:00:00Z\",\n  \"metadata\": {\n    \"businessType\": \"Restaurant\",\n    \"location\": \"New York\",\n    \"purchaseMethod\": \"online\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/license",
              "host": ["{{baseUrl}}"],
              "path": ["license"]
            }
          }
        },
        {
          "name": "Get License by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"License has history\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('history');",
                  "    pm.expect(jsonData.history).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/license/{{licenseId}}",
              "host": ["{{baseUrl}}"],
              "path": ["license", "{{licenseId}}"]
            }
          }
        },
        {
          "name": "Renew License",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"License status is Active\", function () {",
                  "    pm.expect(pm.response.json().status).to.eql('Active');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"renewalDate\": \"2027-11-01T00:00:00Z\",\n  \"paymentReference\": \"PAY-{{$randomInt}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/license/renew/{{licenseId}}",
              "host": ["{{baseUrl}}"],
              "path": ["license", "renew", "{{licenseId}}"]
            }
          }
        },
        {
          "name": "Get Licenses by Tenant",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is an array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/license?status=Active",
              "host": ["{{baseUrl}}"],
              "path": ["license"],
              "query": [
                {
                  "key": "status",
                  "value": "Active"
                }
              ]
            }
          }
        },
        {
          "name": "Get Tenant Users",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response contains users array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/license/users",
              "host": ["{{baseUrl}}"],
              "path": ["license", "users"]
            }
          }
        },
        {
          "name": "Update License Status",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Status updated successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('message');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"Active\",\n  \"reason\": \"Admin activation\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/license/{{licenseId}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["license", "{{licenseId}}", "status"]
            }
          }
        },
        {
          "name": "Delete License",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"License deleted successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('message');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/license/{{licenseId}}",
              "host": ["{{baseUrl}}"],
              "path": ["license", "{{licenseId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Payment Integration",
      "item": [
        {
          "name": "Create Pre-Payment Order",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has razorpay_order_id\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('razorpay_order_id');",
                  "    pm.environment.set(\"razorpayOrderId\", jsonData.razorpay_order_id);",
                  "});",
                  "",
                  "pm.test(\"Response has paymentId\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('paymentId');",
                  "    pm.environment.set(\"paymentId\", jsonData.paymentId);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"licenseId\": 1,\n  \"amount\": 100.00,\n  \"currency\": \"INR\",\n  \"applicantName\": \"John Doe\",\n  \"applicantEmail\": \"john.doe@example.com\",\n  \"licenseType\": \"Business License\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/payment/create-pre-order",
              "host": ["{{baseUrl}}"],
              "path": ["payment", "create-pre-order"]
            }
          }
        },
        {
          "name": "Verify Payment",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Payment verified successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('status');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"razorpay_order_id\": \"{{razorpayOrderId}}\",\n  \"razorpay_payment_id\": \"pay_test123\",\n  \"razorpay_signature\": \"signature_test123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/payment/verify",
              "host": ["{{baseUrl}}"],
              "path": ["payment", "verify"]
            }
          }
        },
        {
          "name": "Get Payment by License ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Payment details returned\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('amount');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payment/license/{{licenseId}}",
              "host": ["{{baseUrl}}"],
              "path": ["payment", "license", "{{licenseId}}"]
            }
          }
        },
        {
          "name": "Download Invoice",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Content-Type is HTML or PDF\", function () {",
                  "    var contentType = pm.response.headers.get('Content-Type');",
                  "    pm.expect(contentType).to.include('html');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payment/invoice/{{paymentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["payment", "invoice", "{{paymentId}}"]
            }
          }
        },
        {
          "name": "Link Payment to License",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Payment linked successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('Status');",
                  "    pm.expect(jsonData.Status).to.eql('SUCCESS');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "PUT",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payment/{{paymentId}}/link-license/{{licenseId}}",
              "host": ["{{baseUrl}}"],
              "path": ["payment", "{{paymentId}}", "link-license", "{{licenseId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Payment Webhook",
      "item": [
        {
          "name": "Payment Webhook (Success)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response acknowledged\", function () {",
                  "    pm.expect(pm.response.json().acknowledged).to.be.true;",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Payment-Signature",
                "value": "mock_signature",
                "description": "For local dev with REQUIRE_SIGNATURE=false"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"paymentReference\": \"PAY-{{$randomInt}}\",\n  \"status\": \"Succeeded\",\n  \"amount\": 100.00,\n  \"currency\": \"USD\",\n  \"tenantId\": \"{{tenantId}}\",\n  \"metadata\": {\n    \"licenseId\": \"{{licenseId}}\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/payment/webhook",
              "host": ["{{baseUrl}}"],
              "path": ["payment", "webhook"]
            }
          }
        }
      ]
    },
    {
      "name": "Document Management",
      "item": [
        {
          "name": "Upload Document",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200 or 201\", function () {",
                  "    pm.expect([200, 201]).to.include(pm.response.code);",
                  "});",
                  "",
                  "pm.test(\"Document uploaded successfully\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('documentId');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": []
                },
                {
                  "key": "licenseId",
                  "value": "{{licenseId}}",
                  "type": "text"
                },
                {
                  "key": "documentType",
                  "value": "Supporting Document",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/document/upload",
              "host": ["{{baseUrl}}"],
              "path": ["document", "upload"]
            }
          }
        },
        {
          "name": "Get Documents by License",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/document/license/{{licenseId}}",
              "host": ["{{baseUrl}}"],
              "path": ["document", "license", "{{licenseId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Notifications",
      "item": [
        {
          "name": "Send Notification",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 202\", function () {",
                  "    pm.response.to.have.status(202);",
                  "});",
                  "",
                  "pm.test(\"Response has messageId\", function () {",
                  "    pm.expect(pm.response.json()).to.have.property('messageId');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"to\": [\"john.doe@example.com\"],\n  \"subject\": \"License Renewal Reminder\",\n  \"body\": \"Your license will expire soon. Please renew.\",\n  \"metadata\": {\n    \"licenseId\": \"{{licenseId}}\",\n    \"priority\": \"high\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/notify/send",
              "host": ["{{baseUrl}}"],
              "path": ["notify", "send"]
            }
          }
        }
      ]
    },
    {
      "name": "Error Scenarios",
      "item": [
        {
          "name": "Missing Tenant Header",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});",
                  "",
                  "pm.test(\"Error code is MISSING_TENANT\", function () {",
                  "    pm.expect(pm.response.json().error.code).to.eql('MISSING_TENANT');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/license/1",
              "host": ["{{baseUrl}}"],
              "path": ["license", "1"]
            }
          }
        },
        {
          "name": "Invalid Tenant ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 400\", function () {",
                  "    pm.response.to.have.status(400);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Tenant-ID",
                "value": "invalid@tenant!"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/license/1",
              "host": ["{{baseUrl}}"],
              "path": ["license", "1"]
            }
          }
        },
        {
          "name": "Unauthorized Access",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 401\", function () {",
                  "    pm.response.to.have.status(401);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Tenant-ID",
                "value": "{{tenantId}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"applicantName\": \"Test User\",\n  \"applicantEmail\": \"test@example.com\",\n  \"licenseType\": \"Business License\",\n  \"expiryDate\": \"2026-01-01T00:00:00Z\",\n  \"metadata\": {\n    \"purchaseMethod\": \"unauthorized_test\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/license",
              "host": ["{{baseUrl}}"],
              "path": ["license"]
            }
          }
        }
      ]
    },
    {
      "name": "Health Checks",
      "item": [
        {
          "name": "License Service Health",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:5001/healthz",
              "protocol": "http",
              "host": ["localhost"],
              "port": "5001",
              "path": ["healthz"]
            }
          }
        },
        {
          "name": "API Gateway Health",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/license/healthz",
              "host": ["{{baseUrl}}"],
              "path": ["license", "healthz"]
            }
          }
        }
      ]
    }
  ]
}
